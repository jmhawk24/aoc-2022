(ns advent-of-code-2022.day1
  (:require [clojure.string :as str]))


(def a "9524\n12618\n6755\n2121\n12876\n11330\n\n4029\n11446\n11571\n2683\n3454\n12411\n\n6226\n9901\n6735\n7602\n4045\n4643\n5047\n2329\n\n5576\n23361\n16052\n\n5523\n12113\n3128\n5978\n4683\n3458\n\n32135\n15179\n\n7380\n9715\n5985\n9547\n9207\n6882\n4407\n1688\n\n9175\n4868\n3374\n6053\n5304\n4585\n1344\n5036\n\n4807\n1180\n6655\n4572\n3864\n4674\n6759\n6861\n4273\n2387\n1085\n1598\n\n1807\n13594\n13712\n7385\n\n6607\n6858\n3872\n5554\n5802\n1174\n5234\n6082\n6672\n4180\n1491\n4111\n1721\n\n6508\n4569\n2836\n7992\n2876\n4464\n5023\n2920\n3794\n6274\n\n3229\n2998\n15582\n12963\n14718\n\n32390\n\n2517\n6446\n6777\n5881\n7923\n5523\n4904\n3018\n5737\n4826\n\n5911\n6152\n2479\n3949\n3427\n5924\n6432\n6746\n6878\n5884\n3309\n3674\n2026\n\n11177\n1872\n15245\n16212\n6512\n\n23534\n21079\n\n5725\n8219\n7284\n1011\n1903\n2835\n\n3194\n3712\n5969\n6069\n4264\n4616\n5424\n5382\n4772\n1908\n1707\n2222\n2778\n3712\n\n10329\n26374\n\n4180\n3086\n5044\n1980\n5636\n2776\n5399\n3898\n1353\n4864\n5504\n5631\n3373\n\n11290\n1294\n2117\n13739\n9724\n11236\n\n9653\n13620\n20041\n8914\n\n29248\n32773\n\n2316\n3761\n4458\n4592\n5963\n2118\n6079\n2024\n3928\n4745\n2965\n1748\n2824\n5740\n5189\n\n1307\n5004\n2336\n7721\n1757\n5155\n4671\n2734\n4884\n5549\n\n16255\n\n4892\n4077\n1163\n7588\n\n4887\n4197\n3782\n5889\n6735\n5729\n2783\n3170\n3062\n6874\n5479\n\n4352\n3701\n5794\n4775\n1622\n2128\n1063\n1009\n1702\n4405\n4455\n1304\n5133\n1374\n2677\n\n6261\n1307\n5579\n6582\n6098\n5375\n4876\n4747\n3285\n6389\n2660\n\n68718\n\n3578\n5102\n3755\n2031\n6961\n6433\n6081\n2957\n1770\n1280\n4229\n7081\n\n9388\n11343\n5178\n2164\n10275\n6054\n5742\n\n8550\n7983\n8330\n8883\n9575\n9300\n8453\n6367\n5770\n\n5374\n5460\n5590\n6433\n5785\n3128\n1194\n5369\n3032\n6351\n2210\n4725\n2942\n5483\n\n28182\n\n36912\n27721\n\n15006\n4561\n2828\n\n2120\n4019\n4685\n1360\n4315\n2733\n1546\n3986\n3071\n4308\n6705\n1480\n2075\n\n4452\n7034\n6770\n8934\n8125\n6333\n2856\n7908\n5145\n\n2068\n1714\n6972\n5061\n6633\n4180\n5603\n5186\n6986\n3112\n5696\n\n1164\n4408\n7118\n7230\n1636\n5958\n2070\n2091\n3158\n6631\n\n6888\n5446\n3132\n1888\n2668\n1529\n1568\n1901\n4708\n2815\n8079\n\n2394\n1604\n6133\n1886\n2648\n3636\n2998\n5510\n1422\n5184\n3436\n6317\n3481\n3109\n\n13992\n8555\n\n3038\n5447\n5010\n10502\n9033\n4127\n9385\n7438\n\n5561\n14448\n15742\n9477\n15244\n\n1824\n7913\n3167\n2770\n6853\n5049\n8970\n3980\n3792\n\n5263\n1495\n6398\n3191\n1787\n4516\n4528\n1984\n2209\n2937\n1917\n\n7093\n4995\n11710\n8145\n2509\n11002\n2329\n\n2772\n9223\n7429\n5951\n5211\n5390\n9636\n5015\n9576\n\n9143\n19336\n8940\n14860\n\n1615\n2033\n1853\n3334\n10998\n5591\n10429\n\n3400\n6270\n6159\n1199\n6841\n1411\n2272\n2298\n8236\n\n2641\n9002\n8338\n13253\n9830\n\n2121\n6314\n5463\n\n16712\n\n20041\n15769\n6691\n8310\n\n17869\n15266\n3313\n\n3453\n4166\n6214\n4735\n6756\n7020\n4624\n4679\n1779\n3429\n1133\n4630\n\n2207\n16017\n2824\n13752\n6355\n\n13493\n12177\n9701\n1146\n2421\n\n6461\n5774\n5822\n5873\n7594\n7653\n6871\n7934\n6083\n4111\n7399\n\n14561\n4204\n17338\n9054\n\n5551\n2880\n4587\n7339\n7793\n8194\n5359\n8702\n6846\n\n4827\n6451\n2666\n7916\n2321\n2258\n\n7352\n\n17612\n30650\n\n13845\n9073\n7678\n15430\n3256\n\n13079\n12502\n8332\n12919\n\n15980\n14653\n5439\n2880\n15145\n\n26007\n\n18376\n8663\n11423\n7152\n\n3832\n5843\n3919\n5658\n1615\n5840\n3009\n5725\n2639\n5239\n4380\n2298\n4618\n2586\n\n15785\n8518\n4131\n8614\n\n4718\n5897\n7178\n2031\n3409\n7218\n6794\n8699\n4119\n6928\n\n2129\n2231\n2489\n5616\n1467\n2225\n5657\n4127\n6286\n5359\n4725\n1819\n5550\n\n6079\n7050\n13912\n13912\n12870\n4966\n\n5974\n3386\n2793\n4898\n2975\n3865\n5974\n3655\n3838\n1822\n3322\n1610\n5610\n3243\n\n4090\n1110\n4663\n2618\n1587\n3417\n4401\n3837\n2593\n4503\n1746\n4797\n1821\n3502\n2592\n\n4955\n4020\n13061\n7532\n12446\n\n4084\n1491\n5988\n6646\n2061\n2083\n1761\n5146\n4656\n5620\n3959\n6133\n3161\n\n9795\n2854\n6539\n1197\n7913\n6560\n1912\n5636\n\n3964\n6541\n3226\n3536\n6335\n6956\n3656\n4149\n6859\n4609\n4456\n2856\n3395\n\n16002\n11740\n6583\n\n8056\n21295\n6331\n\n12521\n14781\n2837\n18442\n\n7673\n12780\n3682\n\n2104\n2166\n4813\n\n5722\n5243\n3506\n4961\n3587\n5584\n8571\n6724\n6901\n5278\n\n3464\n4099\n2514\n6217\n2209\n6501\n5950\n3218\n4821\n3121\n4106\n4451\n1228\n\n5147\n5877\n1170\n4801\n4153\n3710\n1673\n5553\n5992\n5173\n4277\n1451\n5158\n3766\n3191\n\n12693\n13232\n5554\n12330\n7602\n6490\n\n1168\n14381\n11380\n6522\n4822\n\n3956\n12204\n1708\n13838\n7704\n5066\n\n5436\n3448\n4345\n7430\n6934\n1717\n4553\n4683\n7091\n5718\n4289\n1140\n\n2321\n1291\n2159\n7409\n3502\n4266\n2190\n5307\n1971\n2217\n\n8168\n4475\n7287\n9416\n6264\n2691\n4551\n5109\n3286\n\n31132\n31889\n\n6154\n6665\n7026\n11383\n13857\n8357\n\n10312\n3810\n7818\n6172\n7615\n9201\n1937\n\n9067\n6897\n4655\n5091\n2824\n7062\n1336\n1835\n3831\n\n4839\n5218\n6044\n4868\n6466\n4237\n2814\n2210\n3365\n6128\n2713\n5229\n4600\n1466\n\n1225\n5350\n3013\n1102\n7614\n3002\n4451\n2059\n1843\n6158\n\n57499\n\n2273\n8394\n9347\n4833\n9001\n8823\n7674\n1882\n9235\n\n3759\n7106\n1671\n1596\n7855\n3616\n4858\n\n4966\n6050\n2267\n2082\n3664\n1812\n4412\n6457\n5080\n3280\n6407\n3124\n5993\n2142\n\n2728\n2912\n1566\n5990\n7139\n1082\n6536\n1213\n\n6118\n4821\n3134\n5633\n3091\n3618\n5465\n4116\n1577\n2776\n4592\n4923\n5812\n\n12233\n1056\n12928\n6106\n\n8177\n12942\n13879\n2729\n11070\n7560\n\n3359\n1950\n3396\n7128\n1724\n6590\n5952\n2255\n1022\n5923\n4381\n2670\n\n5619\n5474\n2892\n5214\n2677\n4596\n4314\n2790\n4749\n6478\n6865\n3755\n3747\n\n1888\n4764\n5673\n6832\n8312\n5569\n3874\n1831\n1742\n1953\n\n6154\n5064\n2106\n11402\n8462\n\n7116\n2820\n5625\n5143\n3055\n1554\n4279\n5644\n1908\n6292\n4492\n\n7544\n6590\n6098\n7178\n7354\n1570\n8934\n1544\n6880\n\n66910\n\n12946\n\n6226\n7319\n12112\n6817\n8025\n2668\n\n2630\n1137\n2881\n2123\n4994\n3215\n3315\n2353\n4031\n4151\n1609\n5278\n\n13286\n5182\n14123\n\n6100\n4344\n7043\n9434\n6107\n3579\n1697\n3166\n3414\n\n11329\n35988\n\n5631\n7749\n1074\n4825\n2650\n6835\n6433\n5946\n4203\n4514\n2944\n\n7860\n1341\n2546\n10857\n11814\n11301\n9280\n\n5318\n8457\n6221\n1419\n1715\n6222\n9581\n5606\n2293\n\n9296\n11898\n8802\n3804\n1796\n13910\n\n12885\n10836\n17345\n7449\n\n2666\n2481\n6683\n1783\n4880\n5339\n5075\n1043\n6314\n1440\n5100\n1647\n2095\n\n4698\n7755\n2595\n1730\n5954\n3714\n5023\n4167\n2202\n4679\n1165\n\n4431\n3109\n3055\n1713\n1848\n4118\n1730\n2280\n1079\n3688\n1569\n2995\n4061\n\n3757\n4427\n4747\n2214\n3723\n1434\n7512\n1878\n3167\n\n2122\n17054\n9678\n8169\n\n2437\n3160\n2215\n3949\n2996\n4494\n1615\n5174\n6019\n6055\n3186\n3229\n5248\n5656\n1847\n\n4314\n5032\n5345\n3719\n2918\n3847\n2708\n1834\n2603\n2200\n3822\n6052\n2997\n1540\n1846\n\n3626\n1064\n5420\n3228\n1444\n5662\n5600\n4544\n5177\n2309\n2186\n2638\n3164\n5703\n6079\n\n28701\n30412\n\n11849\n11080\n24418\n\n3926\n4456\n3783\n3058\n1752\n4944\n6732\n6587\n2578\n3490\n1730\n\n3862\n12513\n6788\n4010\n1427\n1098\n\n9313\n8444\n16375\n14666\n15215\n\n2819\n1623\n4195\n1981\n2908\n4730\n2621\n4136\n4824\n3588\n2979\n1583\n1776\n1845\n3772\n\n3668\n3119\n4402\n5814\n4507\n3147\n4834\n1171\n4102\n5458\n4930\n5098\n1284\n5117\n\n3889\n7447\n1031\n6800\n4884\n6483\n1577\n7164\n2778\n6216\n3167\n5458\n\n12710\n14353\n9583\n5759\n16081\n\n3156\n4905\n4799\n2502\n7230\n6169\n2350\n4196\n4384\n5939\n2889\n1349\n\n4978\n5247\n10881\n3833\n13656\n8822\n\n4063\n3379\n4073\n3091\n2733\n4759\n5051\n5605\n3114\n2039\n6049\n4568\n5013\n1991\n4239\n\n22021\n21472\n15888\n\n23871\n33564\n\n1475\n1319\n6422\n2086\n1101\n2435\n1661\n6011\n5927\n4798\n4770\n4860\n4821\n6438\n\n45424\n\n3704\n6982\n7230\n4807\n6677\n6131\n2698\n3048\n4914\n3656\n4707\n\n1883\n5114\n2366\n2220\n3239\n2574\n3754\n2711\n6984\n7464\n6208\n\n5881\n5964\n5999\n4260\n2501\n3387\n3112\n5323\n4895\n3715\n2183\n2900\n4867\n1975\n3961\n\n5874\n3960\n5490\n6056\n5222\n6205\n1153\n5491\n4156\n3921\n4369\n1195\n\n1540\n3601\n6238\n2433\n5286\n1272\n1567\n2425\n5797\n5222\n3213\n6021\n6519\n\n17672\n19343\n11461\n8143\n\n6489\n5442\n4307\n1773\n4716\n1220\n5407\n2997\n4763\n2629\n5102\n\n6014\n6309\n4072\n8155\n7481\n6771\n8686\n5980\n6754\n5761\n\n69172\n\n4781\n6068\n4342\n6091\n4340\n5890\n2973\n4214\n2884\n1782\n3622\n3240\n2185\n1947\n4634\n\n11595\n22943\n\n1583\n9915\n2518\n3285\n12248\n\n56794\n\n1266\n8056\n3268\n7231\n3018\n2774\n2415\n5377\n4227\n5428\n1113\n\n3527\n5534\n4501\n8409\n3396\n5553\n10346\n\n2931\n4457\n6108\n5058\n3393\n5132\n2076\n4461\n3353\n4568\n2182\n2493\n3285\n1592\n5370\n\n15869\n8031\n\n6349\n5106\n1725\n4758\n5364\n3316\n4235\n4813\n4421\n1682\n2133\n3691\n\n39362\n\n1243\n6663\n7560\n10078\n1589\n8782\n9184\n9149\n\n4761\n21813\n24493\n\n8335\n9413\n5100\n7001\n4090\n6375\n9420\n6864\n3263\n\n2101\n3950\n6076\n1739\n5749\n4174\n5849\n5463\n4750\n5934\n4202\n6119\n1588\n1637\n\n3545\n4228\n7420\n10436\n5854\n10021\n7383\n\n2430\n5591\n3145\n13825\n\n14058\n4268\n12789\n11917\n2470\n\n4661\n1018\n4383\n4852\n1090\n5644\n3953\n1204\n2819\n3500\n2749\n5615\n3939\n5118\n3128\n\n2882\n3718\n2670\n2190\n1495\n3551\n5497\n3264\n6484\n6199\n2011\n4157\n5896\n6046\n\n34056\n\n2090\n8624\n11777\n\n7414\n4519\n1108\n8667\n8481\n5032\n10813\n\n3466\n9107\n2058\n1813\n2236\n8430\n2923\n7801\n7506\n\n3315\n1937\n2698\n1647\n3083\n5874\n4801\n4649\n1311\n5306\n4655\n4981\n2325\n2130\n2261\n\n37135\n\n1831\n4702\n5322\n5424\n4620\n3951\n1275\n1074\n1767\n4751\n2512\n4367\n2623\n6175\n\n23083\n30515\n\n1765\n3327\n5205\n4124\n2834\n5524\n1945\n4393\n3958\n1021\n4989\n1142\n1960\n\n11170\n3970\n11159\n5081\n5508\n9043\n6180\n\n6216\n3861\n1281\n1935\n2128\n1550\n5869\n4139\n6307\n5320\n4740\n5970\n4039\n\n8019\n1455\n3994\n10337\n3779\n7604\n9614\n7636\n\n5463\n10532\n13499\n\n3967\n4866\n2889\n4428\n1896\n2064\n3350\n2802\n5240\n5626\n1206\n2169\n3757\n3481\n\n26031\n10122\n\n12480\n5566\n21219\n\n57426\n\n17286\n1875\n6596\n2739\n\n2182\n4147\n2513\n4571\n1569\n2946\n1972\n3032\n3580\n5820\n4722\n3358\n4456\n2945\n1417\n\n16228\n13578\n12393\n13426\n\n4372\n5930\n4010\n5308\n3557\n6006\n2054\n4331\n4274\n1501\n1532\n2900\n3255\n6106\n6061\n\n9386\n18674\n17741\n14487\n\n4117\n5801\n4046\n2354\n3552\n4774\n2218\n4651\n4221\n6622\n3388\n2588\n\n7925\n5719\n2382\n6087\n7799\n5066\n5100\n4925\n5764\n5262\n6232\n\n12700\n2207\n\n7062\n9723\n4933\n8313\n8988\n9771\n8549\n10278\n\n10827\n4384\n3514\n12710\n12592\n2531\n\n15038\n13852\n2993\n6765\n1799\n\n19487\n10768\n\n2715\n7932\n12032\n10044\n3722\n\n2465\n6819\n3758\n7537\n1607\n3958\n2502\n7743\n1448\n6763\n7543\n\n3664\n6265\n2609\n1884\n5972\n4086\n4523\n6108\n5073\n5407\n4410\n2353\n3627\n4617\n\n5816\n2375\n7279\n6266\n4691\n6941\n6754\n1496\n5536\n1911\n4220\n\n3776\n1762\n5809\n8808\n1028\n1768\n7751\n2274\n5136\n4402\n\n19168\n27638\n\n16145\n17357\n7612\n10493\n\n6387\n6862\n6673\n5873\n6094\n4189\n3313\n3217\n3310\n1580\n4793\n5262\n2933\n\n22224\n11444\n\n6708\n1285\n1573\n2512\n4161\n2397\n5196\n2829\n2105\n5197\n\n3478\n4256\n1755\n3308\n1105\n2738\n4607\n3867\n2306\n3615\n2686\n5102\n5659\n3177\n4846\n\n13577\n14550\n5133\n11050\n7976\n\n2082\n5860\n3018\n8157\n2087\n1462\n2164\n2651\n6380\n3549\n\n1849\n4313\n9018\n5235\n5785\n3287\n1464\n6853\n2251\n\n4937\n4124\n4119\n2485\n3358\n5815\n4338\n2249\n5615\n5378\n1533\n1035\n2194\n1521\n\n24714\n16695\n23212\n\n1679\n1745\n5214\n4118\n6052\n4962\n3633\n3355\n2768\n2857\n2124\n4280\n4754\n1535\n2400\n\n5507\n5947\n7455\n6774\n2836\n2126\n3098\n1685\n6404\n4302\n4508\n1739\n\n3315\n18956\n13505\n17849\n\n7127\n2867\n\n4170\n3426\n2878\n4025\n3745\n4267\n2678\n6439\n1986\n3401\n1323\n4225\n6003\n5156\n\n5715\n8382\n2666\n14581\n11008\n\n31882\n15152\n\n3976\n2654\n4849\n2090\n5774\n1173\n2645\n4282\n3014\n3082\n6723\n6860\n2129\n\n5783\n8750\n4604\n7494\n5460\n6231\n4198\n5747\n7406\n7529\n\n1360\n17274\n9730\n13453\n\n3154\n8490\n5069\n6268\n4530\n2929\n7829\n9000\n4835\n\n1441\n3255\n5210\n1328\n1628\n3809\n2422\n3055\n4402\n2905\n2375\n2369\n5513\n4352\n3749\n\n3015\n2463\n8928\n8067\n9196\n4077\n5189\n2392\n2574\n\n1847\n3374\n3505\n3451\n2323\n5703\n1466\n5226\n1553\n7253\n1835\n6210\n\n4886\n5970\n2459\n4117\n3866\n5168\n5914\n6819\n2291\n6510\n6039\n4553\n2686\n\n5613\n1938\n5481\n3692\n5223\n1505\n3628\n1095\n4340\n2681\n5657\n1811\n1233\n\n2815\n7505\n3875\n1236\n2028\n3022\n8262\n6240\n6295\n7060\n\n45267\n\n16209\n17734\n\n3318\n1727\n4971\n5208\n8009\n8009\n6117\n7870\n4824\n7741\n1278\n\n1854\n4926\n3228\n6199\n1312\n2417\n4413\n1801\n4145\n4604\n4296\n5636\n5169\n6081\n\n7523\n3390\n2318\n8663\n7609\n1722\n5343\n8124\n1579\n2959\n\n4172\n21931\n22824\n\n2561\n3470\n3018\n6387\n4774\n5611\n4904\n5883\n6144\n4977\n1863\n1613\n3160\n4236\n\n3059\n2276\n1441\n3886\n2204\n3853\n3910\n5347\n5630\n5721\n6630")

(defn read-cals [cal-list]
  (str/split cal-list #"\n"))

(defn split-by-elf [cal-coll]
  (partition-by #(= "" %) cal-coll))

(defn drop-empties [cal-str-by-elf-with-empties]
  (remove #(empty? (first %)) cal-str-by-elf-with-empties))

(defn combine-strs-to-ints [cal-str-by-elf]
  (map
    #(reduce
       (fn [cal-total next]
         (+
           cal-total
           (Integer/parseInt next)))
       0
       %)
    cal-str-by-elf))


(defn part1 [inputs]
  (->> (read-cals inputs)
       split-by-elf
       drop-empties
       combine-strs-to-ints
       (apply max)))

(defn part2 [inputs]
  (->> (read-cals a)
       split-by-elf
       drop-empties
       combine-strs-to-ints
       sort
       (take-last 3)
       (apply +)))